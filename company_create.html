<!DOCTYPE html>
<html lang="tr">
<head>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script>
        // ... (Firebase initialization - REMOVE IN PRODUCTION) ...

        function saveCompany(event) {
            event.preventDefault();

            // ... (Get form values) ...
            const taxNumber = document.getElementById("taxNumber").value.trim(); // Get tax number

            // ... (Validation - Add format validation here) ...

            const companyData = {
                customerNumber,
                companyName,
                contactName,
                phone,
                address,
                notes,
                taxNumber, // Include tax number
                registerDate: new Date().toLocaleString("tr-TR")
            };

            // Show loading indicator (implement this visually)
            document.getElementById("loading-indicator").style.display = "block";

            db.collection("companies").add(companyData)
                .then(() => {
                    alert(`Şirket başarıyla kaydedildi!\nMüşteri Numarası: ${customerNumber}`);
                    document.getElementById("companyForm").reset(); // Clear the form
                    window.location.href = "admin.html?customerNumber=" + customerNumber; // Redirect with customerNumber
                })
                .catch((error) => {
                    console.error("Error saving company:", error); // Log the error for debugging
                    alert("Bir hata oluştu: " + error.message); // Display a more user-friendly message
                })
                .finally(() => {
                    // Hide loading indicator
                    document.getElementById("loading-indicator").style.display = "none";
                });
        }

        window.onload = function() {
            document.getElementById("companyName").focus(); // Focus on the first input
        };
    </script>
</head>
<body>
    <div class="container">
        <h1>Şirket Oluştur</h1>
        <form id="companyForm" onsubmit="saveCompany(event)">
            <div id="loading-indicator" style="display:none;">Loading...</div>  </form>
    </div>
</body>
</html>
